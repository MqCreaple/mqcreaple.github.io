---
title: 函数极值综述
layout: blog
tags: ["math", "calculus"]
---

## 什么是极值？

函数的极值，可以理解为函数在某一局部上的最值，即图像上“峰”和“谷”位置的点。例如下图：

![MT0000](/img/MT0000.jpg)

![MT0001](/img/MT0001.jpg)

找到极值点，对我们寻找函数的最值也很有帮助——**最大值点一定是极大值点，最小值点一定是极小值点**。 因此如果我们要寻找某一区间中的最值点，只需要先找到极值点和区间端点，接着找出这些点中最大的和最小的，即为最大值点和最小值点

那么问题来了，极值点怎么找呢？

## 导数和梯度

直观上想，函数在某一个局部的最大值或最小值，它的附近应该是平缓的，而非极值点的位置附近应该有一定的坡度：

![MT0002](/img/MT0002.jpg)

学过一点微积分的同学们应该知道，其实某一个点附近的坡度，就是该点的导数$\frac{\mathrm df}{\mathrm dx}$， 而极大、极小值点，就等价于该点附近导数为0，即

$$\frac{\mathrm df}{\mathrm dx}=0$$

当然，这个规律也可以推广到多维函数，只不过我们不再使用导数，而是**偏导数**

![cmich.edu-pderv1](/img/cmich.edu-pderv1.gif)

对于某个多元函数，偏导数就是在某个特定方向上的导数。 例如$\frac{\partial f(x,y)}{\partial x}$就是函数某点在$x$轴截面上的导数， $\frac{\partial f(x,y)}{\partial y}$同理

类比导数的定义: $\frac{\mathrm df(x)}{\mathrm dx}=\lim\limits_{\Delta x\to 0}\frac{f(x+\Delta x)-f(x)}{\Delta x}$, 我们可以给出偏导数的定义：

$$ \frac{\partial f(x,y)}{\partial x}=\lim\limits_{\Delta x\to 0}\frac{f(x+\Delta x, y)-f(x,y)}{\Delta x} $$

$$ \frac{\partial f(x,y)}{\partial y}=\lim\limits_{\Delta y\to 0}\frac{f(x, y+\Delta y)-f(x,y)}{\Delta y} $$

每一个方向上的偏导数，都对应着一条曲线的切线。 而我们知道，经过两个点的直线可以唯一确定一个平面（即曲线的切平面），因此可以引入一个新的量来描述这个切平面：**梯度 gradient**

$$\nabla f=\left(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}\right)$$

梯度永远指向函数增长最快的方向，并且增长越快，切平面越倾斜，梯度向量越大

不难想到，对于多元函数的极值点（即“山峰”和“盆地”处），应当满足该位置的切平面与大地水平，换句话说就是：**梯度为0**

$$\nabla f(x,y)=\vec 0$$

![MT0003](/img/MT0003.jpg)

## Be Careful!

然鹅，你仍然需要保持警惕：**梯度为0的点，不一定是极值点，更不一定是最值点！**

像这样的点，统称为**鞍点**

比如说下面这张图中的函数为$y=x^3$，它在$x=0$处的导数恰好为0，可是这个位置既不是极大值也不是极小值：

![MT0004](/img/MT0004.jpg)

多元函数中这样的例子则就更多了。比如，在两个山峰之间存在着一个“鞍点”，见下图：

![MT0005](/img/MT0005.jpg)

这个点从x方向上看是极小值点，而从y方向上看是极大值点，总不能说它既是极大值又是极小值吧！ 因此这个点虽然梯度为0，但并不是极值点

它的梯度场形状如下：

![MT0006](/img/MT0006.jpg)

## 总结一下

寻找函数极值

- 极值点的导数/梯度一定为0
- 某些导数/梯度为0的点不是极值
    - 一元函数：当函数左右两侧同时单调增或同时单调减时
    - 多元函数：（鞍点）从一个角度看是极大值，另一个角度看是极小值时
- 方法：首先计算函数的导数/梯度，令其为0，解方程得到所有的驻点，接着逐个筛选出其中的极值点

寻找函数在某一区间上/某一范围内的最值，步骤：

1. 找到在该区间内的所有极值点
1. 计算边界点上的函数值
1. 比较所有区间内的极值点和边界点，最大的就是最大值，最小的就是最小值

寻找整个函数的最值，步骤：

1. 找到函数的所有极值点
1. 计算$\lim\limits_{x\to +\infty}f(x),\lim\limits_{x\to -\infty}f(x)$
    - 若其为$+\infty$，则函数没有最大值
    - 若其为$-\infty$，则函数没有最小值
    - 若一个是$+\infty$，另一个是$-\infty$，则函数没有最值
1. 比较所有极值点和函数的两个极限，最大的就是最大值，最小的就是最小值

## 练习题

### part 1: 计算

1. 求$f(x)=\frac15x^3+x^2-4x+5$的极值
1. 求$f(x,y)=-5x^2-8y^2-2xy+42x+102y$的极值
1. 求$f(x,y)=x\ln x+y\ln y$的极值
1. 求$f(x,y)=\ln(x^2+y^2+1)-\ln x$的极值

### part 2: 应用

（线性回归）统计学上为了衡量一系列数据的趋势，往往需要用一条直线来拟合这些数据

现在有三个点：$A_1(1,5),A_2(2,13),A_3(3,19)$，你需要用直线$f(x)=ax+b$来拟合它们。我们使用

$$c=\sum\limits_{n=1}^3 (f(n)-y_n)^2$$

来衡量函数的拟合程度，其中$f(n)$就是$x=n$时$f(x)$的取值，$y_n$是第$n$个点的纵坐标

![MT0007](/img/MT0007.jpg)

你的目标是让$c$函数尽量小，从而使直线尽量接近原有的数据。如何算出这条直线？最终算出来的$a,b$大约是多少？

你能把这个规律推广到任意多个数据点吗？

### part 3: 思考

有时候我们需要计算多元函数在某一封闭曲线$\phi(x,y)=0$内部的最大值和最小值

根据之前的知识，我们知道，不仅区间内的极值点需要考虑，边界上的所有点也有可能成为极值点

那么，如何求解函数$f(x,y)$在某一边界条件$\phi(x,y)=0$的最值呢？